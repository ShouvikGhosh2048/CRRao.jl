CRRao.set_rng(123)

mtcars = dataset("datasets", "mtcars")
model = @fitmodel((MPG ~ HP + WT + Gear), mtcars, LinearRegression())

@test model.fit.cols ≈ [
    [32.01365679074491, -0.03678605889338903, -3.1978106240485467, 1.0199808687184484], 
    [4.632264086003881, 0.009891461620298145, 0.8465458699304196, 0.8514083837234175], 
    [6.9110172037626985, -3.7189709979666525, -3.7774806276136994, 1.1979925124272586], 
    [1.6383852102488675e-7, 0.0008879421680332547, 0.0007605933136019097, 0.2409627017003867], 
    [22.524893954292942, -0.05704779951920132, -4.931881229871286, -0.7240501450849461], 
    [41.50241962719688, -0.016524318267576752, -1.4637400182258071, 2.764011882521843]
]

@test model.sigma ≈ 2.5741691724978977
@test model.LogLike ≈ -73.52638935960971
@test model.AIC ≈ 157.05277871921942
@test model.BIC ≈ 164.38145823321804
@test model.R_sqr ≈ 0.8352309600685555
@test model.Adjusted_R_sqr ≈ 0.8175771343616149

@test model.fittedResponse ≈ [
    23.668849952338718, 22.85340824320634, 
    25.253556140740894, 20.746171762311384, 
    17.635570543830177, 20.14663845388644, 
    14.644831040166633, 23.61182872351372, 
    22.525801204993822, 20.568426475004856,
    20.568426475004856, 15.437019556212643, 
    16.52427516838915, 16.364384637186724, 
    10.743951547500636, 9.819671909982297, 
    9.520508065881298, 26.630517005748224, 
    29.016241045324072, 27.83450394241933, 
    23.622748495961854, 18.299397166241015, 
    18.57121106928514, 13.781422171673526, 
    16.340457241090512, 27.47793682112109,
    26.922715039574857, 28.11844900519874, 
    17.264981908248554, 21.818065399379595,
    13.374047477198516, 23.193986311384343
]

@test model.residuals ≈ [
    -2.668849952338718, -1.8534082432063386, 
    -2.4535561407408935, 0.6538282376886144, 
    1.0644294561698224, -2.0466384538864375, 
    -0.3448310401666319, 0.7881712764862776, 
    0.2741987950061784, -1.3684264750048563, 
    -2.768426475004855, 0.9629804437873553, 
    0.7757248316108516, -1.1643846371867248, 
    -0.3439515475006356, 0.5803280900177032, 
    5.179491934118701, 5.769482994251774, 
    1.3837589546759261, 6.065496057580667, 
    -2.1227484959618543, -2.7993971662410146, 
    -3.371211069285142, -0.4814221716735254, 
    2.8595427589094875, -0.1779368211210901, 
    -0.9227150395748573, 2.2815509948012576, 
    -1.4649819082485536, -2.1180653993795957, 
    1.6259525228014837, -1.7939863113843444
]

@test model.Cooks_distance ≈ [
    0.013342034282302797, 0.006887282667312196, 
    0.015495847517059158, 0.0014309089637597762,
    0.00447197921392359, 0.014588985833725162, 
    0.0015401004198819339, 0.005826402580871438, 
    0.0003074315682458216, 0.007011803724485459, 
    0.028698077402054694, 0.0025984983592199293, 
    0.0018259935015465612, 0.003961518883315901, 
    0.0014122489772288866, 0.004961031834940678, 
    0.3111039446698831, 0.11872557592945515, 
    0.01267921344874388, 0.18027152389575862,
    0.03551409534596339, 0.02132188661223607, 
    0.033303982249972226, 0.002076825609693457, 
    0.022039704192128574, 0.0001378106083285506, 
    0.006862929526074501, 0.04703889945177856, 
    0.03812045131808726, 0.03540469459036061, 
    0.1371534135504359, 0.00614566032951969
]